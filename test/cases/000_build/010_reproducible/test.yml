# NOTE: Images build from this file likely do not run
kernel:
  image: linuxkit/kernel:5.4.39
  cmdline: "console=ttyS0"
init:
  - linuxkit/init:e93b0bf37b030238d33e04b98e90d087637f3d2c
  - linuxkit/runc:f79954950022fea76b8b6f10de58cb48e4fb3878
  - linuxkit/containerd:6ef473a228db6f6ee163f9b9a051102a1552a4ef

onboot:
  - name: dhcpcd
    image: linuxkit/dhcpcd:2f8a9b670aa6e96a09db56ec45c9f07ef2a811ee
    command: ["/sbin/dhcpcd", "--nobackground", "-f", "/dhcpcd.conf", "-1"]
    # Add some random unsorted caps
    capabilities:
      - CAP_SETGID
      - CAP_DAC_OVERRIDE

services:
  - name: testservice
    image: linuxkit/ip:22f0b3be72f25adb8a38aa67c075d59da49d20f2
    # Some environments
    env:
      - BENV=true
      - ARANDOMENV=foobar
    # Some mounts
    mounts:
      - type: cgroup
        options: ["rw","nosuid","noexec","nodev","relatime"]
      - type: overlay
        source: overlay
        destination: writeable-host-etc
        options: ["rw", "lowerdir=/etc", "upperdir=/run/hostetc/upper", "workdir=/run/hostetc/work"]
    # Some binds
    binds:
      - /var/run:/var/run
      - /foobar:/foobar
      - /etc/foobar:/etc/foobar
      - /etc/aaa:/etc/aaa
    # And some runtime settings
    runtime:
      mkdir: ["/var/lib/docker"]
      mkdir: ["/var/lib/aaa"]

files:
  - path: etc/linuxkit-config
    metadata: yaml

trust:
  org:
    - linuxkit
    - library
